{{#pow-authenticated-container}}
  {{#pow-task-load-container task=this.challengesInitialLoadTask}}
    {{pow-task-load-bar task=this.challengesLoadTask}}

    <div class="d-flex h-100">
      <div local-class="challenges-list" class="list-group list-group-flush flex-shrink-0">
        {{#each this.sortedChallenges as |challenge|}}
          <button
            local-class="challenges-list-item {{if (eq challenge.slug this.selectedChallengeSlug) "active"}}"
            class="list-group-item list-group-item-action d-flex justify-content-between flex-wrap align-items-center flex-shrink-0 px-0"
            {{action this.selectChallenge challenge.slug}}
          >
            <div class="pl-1">
              {{challenge.name}}
            </div>

            {{pow-challenge-progress/badge challenge=challenge class="mr-1"}}

            <div local-class="slim-progress" class="progress w-100 mt-1">
              <div class="progress-bar" style={{css-percent-width challenge.progress}}></div>
            </div>
          </button>
        {{/each}}
      </div>

      <div local-class="content" class="flex-grow-1 p-3">
        {{#if this.selectedChallenge}}
          <div class="card">
            <div class="card-body text-center">
              {{this.selectedChallenge.description}}
            </div>
          </div>

          {{#if this.selectedChallenge.subChallenges}}
            <div class="row mt-3">
              <div class="{{if this.selectedChallenge.leastAdvancedSubChallenges "col-6" "col-12"}}">
                <h4>
                  {{t "components.page.challenges_page.most_advanced_sub_challenges"}}
                </h4>

                <ul local-class="{{unless this.selectedChallenge.leastAdvancedSubChallenges "list-split"}}" class="list-unstyled">
                  {{#each this.selectedChallenge.mostAdvancedSubChallenges as |subChallenge|}}
                    <li class="d-inline-flex justify-content-between align-items-center flex-wrap w-100 p-1">
                      {{subChallenge.description}}
                      {{pow-challenge-progress/badge challenge=subChallenge}}

                      <div local-class="slim-progress" class="progress w-100 mt-1">
                        <div class="progress-bar" style={{css-percent-width subChallenge.progress}}></div>
                      </div>
                    </li>
                  {{/each}}
                </ul>
              </div>

              {{#if this.selectedChallenge.leastAdvancedSubChallenges}}
                <div class="col-6">
                  <h4>
                    {{t "components.page.challenges_page.discarded_sub_challenges"}}
                  </h4>

                  <ul class="list-unstyled">
                    {{#each this.selectedChallenge.leastAdvancedSubChallenges as |subChallenge|}}
                      <li class="d-flex justify-content-between align-items-center flex-wrap p-1">
                        {{subChallenge.description}}
                        {{pow-challenge-progress/badge challenge=subChallenge}}

                        <div local-class="slim-progress" class="progress w-100 mt-1">
                          <div class="progress-bar" style={{css-percent-width subChallenge.progress}}></div>
                        </div>
                      </li>
                    {{/each}}
                  </ul>
                </div>
              {{/if}}
            </div>
          {{/if}}

          {{pow-challenge-progress/doughnut-chart
            class="d-flex justify-content-center mt-4"
            challenge=this.selectedChallenge
            league=this.league
          }}
        {{else}}
          <div class="d-flex h-100 align-items-center justify-content-center">
            <h2 class="m-0">
              {{t
                "components.page.challenges_page.league_remaining"
                league=this.league.name
                relativeTime=(format-relative this.league.endAt)
              }}
            </h2>
          </div>
        {{/if}}
      </div>
    </div>
  {{/pow-task-load-container}}
{{/pow-authenticated-container}}
